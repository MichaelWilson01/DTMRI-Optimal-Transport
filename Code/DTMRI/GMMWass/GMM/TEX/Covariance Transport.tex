\documentclass[]{article}


\usepackage{amsmath}
\usepackage{amssymb}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\usepackage{setspace}
\linespread{1.5}
\usepackage[margin=1in]{geometry}

%opening
\title{Covariance Transport}
%\author{Michael Wilson}

\begin{document}

%\maketitle

%\begin{abstract}
%
%\end{abstract}

Suppose we have 2 sets of points $X,Y \in \mathbb{R}^{n \times d}$ with rows $X_i, Y_i \in S^{d-1}$, centered (in terms of spherical coordinates) at $m_x, m_y \in S^{d-1}$. Define $\tilde{X}_i = Exp_{m_x}^{-1}(X_i)-m_x$ and $\tilde{Y}_i = Exp_{m_y}^{-1}(Y_i)-m_y$. Let $b_x \in \mathbb{R}^{d \times d-1}$ (resp. $b_y$) be (the first d-1 basis vectors of) the PCA basis for $\tilde{X}$ (resp. $\tilde{Y}$). 

Let $\alpha(t)$ denote the geodesic path along $S^{d-1}$ from $m_x$ to $m_y$. Let $b_{x}^{||} + m_y$ denote the resulting vectors after parallel transport of $b_{x} + m_x$ along $\alpha$. Then we can calculate the sample covariance of the vectors in X, after parallel transport along $\alpha$, in terms of $b_y$, as ;  



%We wish to calculate $\Sigma_{\tilde{X}}^{||}$, the sample covariance matrix of $T_{m_x}(X)$, after parallel transport to $T_{m_y}(*)$, in terms of $b_y$. Define 'local coordinates' $\tilde{X} = (Exp_{m_x}^{-1}(X)-m_x)*b_x$, $\tilde{Y} = (Exp_{m_y}^{-1}(Y)-m_y)*b_y$. Let $b_x^{||}$ denote $b_x$ after parallel transport to $T_{m_y}(*)$. Then we can calculate our desired quantity as;

\begin{equation}
	\Sigma_{\tilde{X}}^{||} = ( b_y^T b_x^{||}) \tilde{X}^T \tilde{X} ((b_x^{||})^T b_y)
\end{equation}



\end{document}
